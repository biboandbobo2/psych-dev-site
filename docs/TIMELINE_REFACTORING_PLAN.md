# –ü–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ —Å–∏—Å—Ç–µ–º—ã —Ç–∞–π–º–ª–∞–π–Ω–∞

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-07
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** ~4589 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
**–¶–µ–ª–µ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** ~3000-3500 —Å—Ç—Ä–æ–∫ (—Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –Ω–∞ 25-35%)

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- üìã **[–ì–ª–∞–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](./README.md)** - –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤—Å–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º –ø—Ä–æ–µ–∫—Ç–∞
- üìÖ **[–ì–∞–π–¥ –ø–æ —Å–∏—Å—Ç–µ–º–µ —Ç–∞–π–º–ª–∞–π–Ω–∞](./TimelineGuide.md)** - –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- üìê **[–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](./ARCHITECTURE_GUIDELINES.md)** - –ø—Ä–∞–≤–∏–ª–∞ –∏ best practices
- üîß **[–ü–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ —Ç–µ—Å—Ç–æ–≤](./TESTS_REFACTORING_PLAN.md)** - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –ø–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞
- üõ†Ô∏è **[–ü–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Å—Ç–∏](./CORE_REFACTORING_PLAN.md)** - —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∞–¥–º–∏–Ω–∫–∏, –∑–∞–º–µ—Ç–æ–∫, –ø—Ä–æ—Ñ–∏–ª—è
- üìö **[–°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–æ–≤](./TESTS_SYSTEM_GUIDE.md)** - —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –∑–∞–º–µ—Ç–∫–∏)

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –ø—Ä–æ–±–ª–µ–º—ã](#—Ç–µ–∫—É—â–µ–µ-—Å–æ—Å—Ç–æ—è–Ω–∏–µ-–∏-–ø—Ä–æ–±–ª–µ–º—ã)
2. [–°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞](#—Å—Ç—Ä–∞—Ç–µ–≥–∏—è-—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞)
3. [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞](#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞)
4. [Phase 1: –ë—ã—Å—Ç—Ä—ã–µ –ø–æ–±–µ–¥—ã](#phase-1-–±—ã—Å—Ç—Ä—ã–µ-–ø–æ–±–µ–¥—ã-1-2-–¥–Ω—è)
5. [Phase 2: –°—Ä–µ–¥–Ω–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥](#phase-2-—Å—Ä–µ–¥–Ω–∏–π-—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥-3-5-–¥–Ω–µ–π)
6. [Phase 3: –ì–ª—É–±–æ–∫–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥](#phase-3-–≥–ª—É–±–æ–∫–∏–π-—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥-1-2-–Ω–µ–¥–µ–ª–∏)
7. [–ß–µ–∫–ª–∏—Å—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](#—á–µ–∫–ª–∏—Å—Ç—ã-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
8. [–ü—Ä–æ—Ü–µ–¥—É—Ä—ã –æ—Ç–∫–∞—Ç–∞](#–ø—Ä–æ—Ü–µ–¥—É—Ä—ã-–æ—Ç–∫–∞—Ç–∞)
9. [–ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞](#–º–µ—Ç—Ä–∏–∫–∏-—É—Å–ø–µ—Ö–∞)

---

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –ø—Ä–æ–±–ª–µ–º—ã

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–¥–∞

```
–û–°–ù–û–í–ù–û–ô –ö–û–ú–ü–û–ù–ï–ù–¢:
    2109 —Å—Ç—Ä–æ–∫ - Timeline.tsx                    ‚ùóÔ∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê

–•–£–ö–ò:
      88 —Å—Ç—Ä–æ–∫ - useTimeline.ts                  ‚úÖ –•–æ—Ä–æ—à–æ
      93 —Å—Ç—Ä–æ–∫ - useTimelineHistory.ts           ‚úÖ –•–æ—Ä–æ—à–æ

–ú–û–î–£–õ–ò (src/pages/timeline/):
     115 —Å—Ç—Ä–æ–∫ - types.ts                        ‚úÖ –•–æ—Ä–æ—à–æ
      62 —Å—Ç—Ä–æ–∫ - constants.ts                    ‚úÖ –•–æ—Ä–æ—à–æ
      61 —Å—Ç—Ä–æ–∫ - utils.ts                        ‚úÖ –•–æ—Ä–æ—à–æ

–ö–û–ú–ü–û–ù–ï–ù–¢–´ (src/pages/timeline/components/):
     263 —Å—Ç—Ä–æ–∫ - BulkEventCreator.tsx            ‚ö†Ô∏è  –ù–∞ –≥—Ä–∞–Ω–∏
     243 —Å—Ç—Ä–æ–∫ - SaveEventAsNoteButton.tsx       ‚ö†Ô∏è  –ù–∞ –≥—Ä–∞–Ω–∏
     150 —Å—Ç—Ä–æ–∫ - PeriodBoundaryModal.tsx         ‚úÖ –ü—Ä–∏–µ–º–ª–µ–º–æ
     118 —Å—Ç—Ä–æ–∫ - PeriodizationSelector.tsx       ‚úÖ –•–æ—Ä–æ—à–æ
     112 —Å—Ç—Ä–æ–∫ - IconPickerButton.tsx            ‚úÖ –•–æ—Ä–æ—à–æ
      92 —Å—Ç—Ä–æ–∫ - PeriodizationLayer.tsx          ‚úÖ –•–æ—Ä–æ—à–æ

–£–¢–ò–õ–ò–¢–´ (src/pages/timeline/utils/):
     632 —Å—Ç—Ä–æ–∫ - exporters.ts                    ‚ö†Ô∏è  –ú–æ–∂–Ω–æ —Ä–∞–∑–±–∏—Ç—å
      74 —Å—Ç—Ä–æ–∫ - ageToRange.ts                   ‚úÖ –•–æ—Ä–æ—à–æ

–î–ê–ù–ù–´–ï (src/pages/timeline/data/):
     465 —Å—Ç—Ä–æ–∫ - periodizations.ts               ‚úÖ –î–∞–Ω–Ω—ã–µ, –ø—Ä–∏–µ–º–ª–µ–º–æ

–ò–¢–û–ì–û: ~4589 —Å—Ç—Ä–æ–∫
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **Timeline.tsx (2109 —Å—Ç—Ä–æ–∫)** - –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
   - –°–º–µ—à–∏–≤–∞–µ—Ç UI-—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É, –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–±—ã—Ç–∏–π
   - –°–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
   - –í—ã—Å–æ–∫–∞—è –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞
   - –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (34+ useState)

2. **exporters.ts (632 —Å—Ç—Ä–æ–∫–∏)** - —Ç—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–∞ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
   - JSON, PNG, PDF —ç–∫—Å–ø–æ—Ä—Ç —Å–º–µ—à–∞–Ω—ã
   - –°–ª–æ–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å

3. **–ö—Ä—É–ø–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–∞ –≥—Ä–∞–Ω–∏:**
   - BulkEventCreator.tsx (263 —Å—Ç—Ä–æ–∫–∏)
   - SaveEventAsNoteButton.tsx (243 —Å—Ç—Ä–æ–∫–∏)

### –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã

‚úÖ –û—Ç–ª–∏—á–Ω–∞—è –º–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (types, constants, utils)
‚úÖ –•—É–∫–∏ –Ω–µ–±–æ–ª—å—à–∏–µ –∏ —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
‚úÖ TypeScript –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ö–æ—Ä–æ—à–æ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –ø–æ –ø–∞–ø–∫–∞–º
‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
‚úÖ –ï—Å—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (TimelineGuide.md)

---

## –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

### –ü—Ä–∏–Ω—Ü–∏–ø—ã

1. **–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ—Å—Ç—å**: –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–∞–ª—ã–º–∏ —à–∞–≥–∞–º–∏ —Å –∫–æ–º–º–∏—Ç–∞–º–∏ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏
2. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –∫–∞–∂–¥—ã–π —ç—Ç–∞–ø —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º
4. **–ò–∑–º–µ—Ä–∏–º–æ—Å—Ç—å**: –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –º–µ—Ç—Ä–∏–∫–∏ (—Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã

**–í—ã—Å–æ–∫–∏–π:**
- –†–∞–∑–±–∏—Ç—å Timeline.tsx (2109‚Üí300-400 —Å—Ç—Ä–æ–∫)
- –ò–∑–≤–ª–µ—á—å Canvas –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- –†–∞–∑–¥–µ–ª–∏—Ç—å –ø–∞–Ω–µ–ª–∏ –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

**–°—Ä–µ–¥–Ω–∏–π:**
- –†–∞–∑–¥–µ–ª–∏—Ç—å exporters.ts
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å BulkEventCreator –∏ SaveEventAsNoteButton

**–ù–∏–∑–∫–∏–π:**
- –î–æ–±–∞–≤–∏—Ç—å unit-—Ç–µ—Å—Ç—ã
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏

```bash
# –°–æ–∑–¥–∞—ë–º —Ç–µ–≥ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
git tag -a timeline-refactor-start -m "Timeline before refactoring"
git push origin timeline-refactor-start

# –°–æ–∑–¥–∞—ë–º –≤–µ—Ç–∫—É –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞
git checkout -b refactor/timeline
```

### –®–∞–≥ 2: –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Timeline.tsx
grep -r "Timeline" src/ --include="*.tsx" --include="*.ts"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–º–ø–æ—Ä—Ç—ã
grep -r "from.*timeline" src/ --include="*.tsx" --include="*.ts"
```

### –®–∞–≥ 3: –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã

–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ —Ç–∞–π–º–ª–∞–π–Ω —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è:

```typescript
// src/pages/__tests__/Timeline.test.tsx
import { render } from '@testing-library/react';
import Timeline from '../Timeline';

describe('Timeline', () => {
  it('should render without crashing', () => {
    const { container } = render(<Timeline />);
    expect(container).toBeInTheDocument();
  });
});
```

**–ö–æ–º–º–∏—Ç:** `test: add basic Timeline rendering test`

---

## Phase 1: –ë—ã—Å—Ç—Ä—ã–µ –ø–æ–±–µ–¥—ã (1-2 –¥–Ω—è)

### –ó–∞–¥–∞—á–∞ 1.1: –†–∞–∑–¥–µ–ª–∏—Ç—å exporters.ts

**–ü—Ä–æ–±–ª–µ–º–∞:** 632 —Å—Ç—Ä–æ–∫–∏ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ, —Ç—Ä–∏ —Ä–∞–∑–Ω—ã—Ö —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–∞

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–∞

#### –®–∞–≥–∏:

1. –°–æ–∑–¥–∞—Ç—å `src/pages/timeline/utils/exporters/exportJSON.ts`:

```typescript
import type { TimelineData } from '../../types';

export function exportTimelineJSON(data: TimelineData, filename: string) {
  const json = JSON.stringify(data, null, 2);
  const blob = new Blob([json], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = filename;
  a.click();
  URL.revokeObjectURL(url);
}
```

2. –°–æ–∑–¥–∞—Ç—å `src/pages/timeline/utils/exporters/exportPNG.ts`:

```typescript
export async function exportTimelinePNG(svg: SVGSVGElement, filename: string) {
  // –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –ª–æ–≥–∏–∫—É —ç–∫—Å–ø–æ—Ä—Ç–∞ PNG —Å—é–¥–∞
  // ... (–∫–æ–¥ –∏–∑ exporters.ts)
}
```

3. –°–æ–∑–¥–∞—Ç—å `src/pages/timeline/utils/exporters/exportPDF.ts`:

```typescript
import type { TimelineData, Periodization } from '../../types';

export async function exportTimelinePDF(
  svg: SVGSVGElement,
  data: TimelineData,
  periodization: Periodization | null,
  filename: string
) {
  // –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –ª–æ–≥–∏–∫—É —ç–∫—Å–ø–æ—Ä—Ç–∞ PDF —Å—é–¥–∞
  // ... (–∫–æ–¥ –∏–∑ exporters.ts)
}
```

4. –°–æ–∑–¥–∞—Ç—å `src/pages/timeline/utils/exporters/index.ts`:

```typescript
export { exportTimelineJSON } from './exportJSON';
export { exportTimelinePNG } from './exportPNG';
export { exportTimelinePDF } from './exportPDF';
```

5. –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤ Timeline.tsx:

```typescript
// –ë—ã–ª–æ:
import { exportTimelineJSON, exportTimelinePNG, exportTimelinePDF } from './timeline/utils/exporters';

// –°—Ç–∞–ª–æ:
import { exportTimelineJSON, exportTimelinePNG, exportTimelinePDF } from './timeline/utils/exporters';
```

6. –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª `exporters.ts`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 632 —Å—Ç—Ä–æ–∫–∏ ‚Üí 3 —Ñ–∞–π–ª–∞ –ø–æ ~200 —Å—Ç—Ä–æ–∫
**–ö–æ–º–º–∏—Ç:** `refactor(timeline): split exporters into separate files`

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- ‚úÖ JSON —ç–∫—Å–ø–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ PNG —ç–∫—Å–ø–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ PDF —ç–∫—Å–ø–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ù–µ—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

---

### –ó–∞–¥–∞—á–∞ 1.2: –ò–∑–≤–ª–µ—á—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Å–æ–±—ã—Ç–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞:** –í Timeline.tsx –µ—Å—Ç—å –º–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞ –¥–ª—è —Ä–∞–∑–º–µ—Ä–æ–≤ –∏ –æ—Ç—Å—Ç—É–ø–æ–≤

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤ `constants.ts`

```typescript
// src/pages/timeline/constants.ts

// –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã...

/**
 * –ë–∞–∑–æ–≤—ã–π —Ä–∞–¥–∏—É—Å –∫—Ä—É–∂–∫–∞ —Å–æ–±—ã—Ç–∏—è (–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π)
 */
export const BASE_NODE_RADIUS = 15;

/**
 * –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–¥–∏—É—Å –∫—Ä—É–∂–∫–∞ —Å–æ–±—ã—Ç–∏—è –ø—Ä–∏ –∑—É–º–µ
 */
export const MIN_NODE_RADIUS = 9;

/**
 * –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–¥–∏—É—Å –∫—Ä—É–∂–∫–∞ —Å–æ–±—ã—Ç–∏—è –ø—Ä–∏ –∑—É–º–µ
 */
export const MAX_NODE_RADIUS = 38;

/**
 * –®–∏—Ä–∏–Ω–∞ —Ç–æ–ª—Å—Ç–æ–π –ª–∏–Ω–∏–∏ –¥–ª—è –∫–ª–∏–∫–∞ –ø–æ –≤–µ—Ç–∫–µ
 */
export const BRANCH_CLICK_WIDTH = 24;

/**
 * –®–∏—Ä–∏–Ω–∞ –æ–±—ã—á–Ω–æ–π –ª–∏–Ω–∏–∏ –¥–ª—è –∫–ª–∏–∫–∞ –ø–æ –≤–µ—Ç–∫–µ (–Ω–µ –≤—ã–±—Ä–∞–Ω–∞)
 */
export const BRANCH_CLICK_WIDTH_UNSELECTED = 12;
```

**–ö–æ–º–º–∏—Ç:** `refactor(timeline): extract event size constants`

---

## Phase 2: –°—Ä–µ–¥–Ω–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ (3-5 –¥–Ω–µ–π)

### –ó–∞–¥–∞—á–∞ 2.1: –ò–∑–≤–ª–µ—á—å –ø–∞–Ω–µ–ª–∏ –∏–∑ Timeline.tsx

**–ü—Ä–æ–±–ª–µ–º–∞:** Timeline.tsx —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –¥–ª—è –ª–µ–≤–æ–π –∏ –ø—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–µ–π

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –ø–∞–Ω–µ–ª–µ–π

#### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å TimelineLeftPanel

–°–æ–∑–¥–∞—Ç—å `src/pages/timeline/components/TimelineLeftPanel.tsx`:

```typescript
import { Link } from 'react-router-dom';
import { SPHERE_META, MIN_SCALE, MAX_SCALE, LINE_X_POSITION } from '../constants';
import type { NodeT, Transform } from '../types';

interface TimelineLeftPanelProps {
  currentAge: number;
  ageMax: number;
  onCurrentAgeChange: (age: number) => void;
  viewportAge: number;
  onViewportAgeChange: (age: number) => void;
  transform: Transform;
  onTransformChange: (transform: Transform) => void;
  nodes: NodeT[];
  onClearAll: () => void;
  downloadMenuOpen: boolean;
  onDownloadMenuToggle: () => void;
  onDownloadSelect: (type: 'json' | 'png' | 'pdf') => void;
  downloadButtonRef: React.RefObject<HTMLButtonElement>;
  downloadMenuRef: React.RefObject<HTMLDivElement>;
  worldHeight: number;
  birthBaseYear: number | null;
  formattedCurrentAge: string;
  currentYearLabel: number | null;
}

export function TimelineLeftPanel({
  currentAge,
  ageMax,
  onCurrentAgeChange,
  viewportAge,
  onViewportAgeChange,
  transform,
  onTransformChange,
  nodes,
  onClearAll,
  downloadMenuOpen,
  onDownloadMenuToggle,
  onDownloadSelect,
  downloadButtonRef,
  downloadMenuRef,
  worldHeight,
}: TimelineLeftPanelProps) {
  return (
    <div className="fixed top-4 left-4 z-40">
      <aside
        className="w-36 space-y-3 rounded-3xl border border-slate-200 bg-gradient-to-b from-white to-slate-50/90 p-4 shadow-xl backdrop-blur-md sm:w-40"
        style={{ fontFamily: 'Georgia, serif' }}
      >
        {/* ... –∫–æ–¥ –ª–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏ –∏–∑ Timeline.tsx ... */}
      </aside>
    </div>
  );
}
```

**–†–∞–∑–º–µ—Ä:** ~200 —Å—Ç—Ä–æ–∫
**–ö–æ–º–º–∏—Ç:** `refactor(timeline): extract TimelineLeftPanel component`

#### –®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å TimelineRightPanel

–°–æ–∑–¥–∞—Ç—å `src/pages/timeline/components/TimelineRightPanel.tsx`:

```typescript
import type { SaveStatus } from '../types';
import { PeriodizationSelector } from './PeriodizationSelector';
import { TimelineEventForm } from './TimelineEventForm';
import { TimelineBirthForm } from './TimelineBirthForm';
import { TimelineBranchEditor } from './TimelineBranchEditor';

interface TimelineRightPanelProps {
  saveStatus: SaveStatus;
  selectedPeriodization: string | null;
  onPeriodizationChange: (id: string | null) => void;
  birthSelected: boolean;
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–ø—Å—ã
}

export function TimelineRightPanel(props: TimelineRightPanelProps) {
  return (
    <aside className="fixed right-0 top-0 bottom-0 w-80 border-l border-purple-200 bg-gradient-to-b from-purple-50 to-blue-50 overflow-y-auto z-30">
      {/* ... –∫–æ–¥ –ø—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏ ... */}
    </aside>
  );
}
```

**–†–∞–∑–º–µ—Ä:** ~150 —Å—Ç—Ä–æ–∫
**–ö–æ–º–º–∏—Ç:** `refactor(timeline): extract TimelineRightPanel component`

#### –®–∞–≥ 3: –û–±–Ω–æ–≤–∏—Ç—å Timeline.tsx

```typescript
// Timeline.tsx
import { TimelineLeftPanel } from './timeline/components/TimelineLeftPanel';
import { TimelineRightPanel } from './timeline/components/TimelineRightPanel';

export default function Timeline() {
  // ... state ...

  return (
    <div className="...">
      <TimelineLeftPanel
        currentAge={currentAge}
        ageMax={ageMax}
        // ... props
      />

      {/* Canvas –æ—Å—Ç–∞—ë—Ç—Å—è –∑–¥–µ—Å—å –ø–æ–∫–∞ */}

      <TimelineRightPanel
        saveStatus={saveStatus}
        selectedPeriodization={selectedPeriodization}
        // ... props
      />
    </div>
  );
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Timeline.tsx 2109 ‚Üí ~1700 —Å—Ç—Ä–æ–∫
**–ö–æ–º–º–∏—Ç:** `refactor(timeline): use extracted panel components`

---

### –ó–∞–¥–∞—á–∞ 2.2: –ò–∑–≤–ª–µ—á—å —Ñ–æ—Ä–º—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### –°–æ–∑–¥–∞—Ç—å TimelineEventForm

`src/pages/timeline/components/TimelineEventForm.tsx`:

```typescript
import type { Sphere, EventIconId } from '../types';
import { SPHERE_META } from '../constants';
import { IconPickerButton } from './IconPickerButton';
import { SaveEventAsNoteButton } from './SaveEventAsNoteButton';

interface TimelineEventFormProps {
  formEventId: string | null;
  formEventAge: string;
  formEventLabel: string;
  formEventNotes: string;
  formEventSphere: Sphere | undefined;
  formEventIsDecision: boolean;
  formEventIcon: EventIconId | null;
  onAgeChange: (age: string) => void;
  onLabelChange: (label: string) => void;
  onNotesChange: (notes: string) => void;
  onSphereChange: (sphere: Sphere | undefined) => void;
  onIsDecisionChange: (isDecision: boolean) => void;
  onIconChange: (icon: EventIconId | null) => void;
  onSubmit: () => void;
  onCancel: () => void;
  onDelete: () => void;
  hasFormChanges: boolean;
  createNote: (note: any) => Promise<void>;
}

export function TimelineEventForm(props: TimelineEventFormProps) {
  // ... –∫–æ–¥ —Ñ–æ—Ä–º—ã —Å–æ–±—ã—Ç–∏—è ...
}
```

**–†–∞–∑–º–µ—Ä:** ~150 —Å—Ç—Ä–æ–∫
**–ö–æ–º–º–∏—Ç:** `refactor(timeline): extract TimelineEventForm component`

#### –°–æ–∑–¥–∞—Ç—å TimelineBirthForm

`src/pages/timeline/components/TimelineBirthForm.tsx`:

```typescript
interface TimelineBirthFormProps {
  birthFormDate: string;
  birthFormPlace: string;
  birthFormNotes: string;
  onDateChange: (date: string) => void;
  onPlaceChange: (place: string) => void;
  onNotesChange: (notes: string) => void;
  onSave: () => void;
  onCancel: () => void;
  onClear: () => void;
  hasChanges: boolean;
}

export function TimelineBirthForm(props: TimelineBirthFormProps) {
  // ... –∫–æ–¥ —Ñ–æ—Ä–º—ã —Ä–æ–∂–¥–µ–Ω–∏—è ...
}
```

**–†–∞–∑–º–µ—Ä:** ~80 —Å—Ç—Ä–æ–∫
**–ö–æ–º–º–∏—Ç:** `refactor(timeline): extract TimelineBirthForm component`

#### –°–æ–∑–¥–∞—Ç—å TimelineBranchEditor

`src/pages/timeline/components/TimelineBranchEditor.tsx`:

```typescript
interface TimelineBranchEditorProps {
  selectedEdge: EdgeT | null;
  branchYears: string;
  ageMax: number;
  onBranchYearsChange: (years: string) => void;
  onUpdateBranchLength: () => void;
  onDeleteBranch: () => void;
  onClose: () => void;
}

export function TimelineBranchEditor(props: TimelineBranchEditorProps) {
  // ... –∫–æ–¥ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –≤–µ—Ç–æ–∫ ...
}
```

**–†–∞–∑–º–µ—Ä:** ~70 —Å—Ç—Ä–æ–∫
**–ö–æ–º–º–∏—Ç:** `refactor(timeline): extract TimelineBranchEditor component`

**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ –≤—Å–µ—Ö —Ñ–æ—Ä–º:** Timeline.tsx ~1700 ‚Üí ~1400 —Å—Ç—Ä–æ–∫

---

### –ó–∞–¥–∞—á–∞ 2.3: –ò–∑–≤–ª–µ—á—å Canvas –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

**–ü—Ä–æ–±–ª–µ–º–∞:** SVG-—Ö–æ–ª—Å—Ç –∑–∞–Ω–∏–º–∞–µ—Ç ~600 —Å—Ç—Ä–æ–∫ –≤ Timeline.tsx

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å TimelineCanvas

`src/pages/timeline/components/TimelineCanvas.tsx`:

```typescript
import type { NodeT, EdgeT, BirthDetails, Transform } from '../types';
import { PeriodizationLayer } from './PeriodizationLayer';
import { getPeriodizationById } from '../data/periodizations';
import {
  YEAR_PX,
  LINE_X_POSITION,
  SPHERE_META,
  BASE_NODE_RADIUS,
  MIN_NODE_RADIUS,
  MAX_NODE_RADIUS,
} from '../constants';
import { clamp } from '../utils';

interface TimelineCanvasProps {
  svgRef: React.RefObject<SVGSVGElement>;
  transform: Transform;
  onWheel: (e: React.WheelEvent<SVGSVGElement>) => void;
  onPointerDown: (e: React.PointerEvent<SVGSVGElement>) => void;
  onPointerMove: (e: React.PointerEvent<SVGSVGElement>) => void;
  onPointerUp: () => void;
  worldWidth: number;
  worldHeight: number;
  ageMax: number;
  currentAge: number;
  nodes: NodeT[];
  edges: EdgeT[];
  birthDetails: BirthDetails;
  selectedPeriodization: string | null;
  selectedId: string | null;
  selectedBranchX: number | null;
  draggingNodeId: string | null;
  birthSelected: boolean;
  birthBaseYear: number | null;
  formattedCurrentAge: string;
  currentYearLabel: number | null;
  onNodeClick: (nodeId: string) => void;
  onNodeDragStart: (e: React.PointerEvent, nodeId: string) => void;
  onSelectBirth: () => void;
  onSelectBranchX: (x: number | null) => void;
  onPeriodBoundaryClick: (periodIndex: number) => void;
  cursorClass: string;
}

export function TimelineCanvas(props: TimelineCanvasProps) {
  const {
    svgRef,
    transform,
    worldWidth,
    worldHeight,
    ageMax,
    currentAge,
    nodes,
    edges,
    selectedPeriodization,
    birthBaseYear,
    formattedCurrentAge,
    currentYearLabel,
    // ...
  } = props;

  const adaptiveRadius = clamp(
    BASE_NODE_RADIUS / transform.k,
    MIN_NODE_RADIUS,
    MAX_NODE_RADIUS
  );

  return (
    <div className="absolute inset-0">
      <svg
        ref={svgRef}
        className={`w-full h-full ${props.cursorClass}`}
        onWheel={props.onWheel}
        onPointerDown={props.onPointerDown}
        onPointerMove={props.onPointerMove}
        onPointerUp={props.onPointerUp}
        data-world-width={worldWidth}
        data-world-height={worldHeight}
      >
        <g data-export-root="true" transform={`translate(${transform.x}, ${transform.y}) scale(${transform.k})`}>
          {/* Background */}
          <rect x={0} y={-100} width={worldWidth} height={worldHeight + 200} fill="#ffffff" />

          {/* Periodization layer */}
          <PeriodizationLayer
            periodization={selectedPeriodization ? getPeriodizationById(selectedPeriodization) ?? null : null}
            ageMax={ageMax}
            worldHeight={worldHeight}
            canvasWidth={worldWidth}
            onBoundaryClick={props.onPeriodBoundaryClick}
          />

          {/* Time scale */}
          {/* ... —à–∫–∞–ª–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞ ... */}

          {/* Life line */}
          {/* ... –ª–∏–Ω–∏—è –∂–∏–∑–Ω–∏ ... */}

          {/* Birth marker */}
          {/* ... –º–∞—Ä–∫–µ—Ä —Ä–æ–∂–¥–µ–Ω–∏—è ... */}

          {/* Current age marker */}
          {/* ... –º–∞—Ä–∫–µ—Ä —Ç–µ–∫—É—â–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ ... */}

          {/* Vertical branches (edges) */}
          {/* ... –≤–µ—Ç–∫–∏ ... */}

          {/* Events */}
          {/* ... —Å–æ–±—ã—Ç–∏—è ... */}
        </g>
      </svg>
    </div>
  );
}
```

**–†–∞–∑–º–µ—Ä:** ~400 —Å—Ç—Ä–æ–∫
**–ö–æ–º–º–∏—Ç:** `refactor(timeline): extract TimelineCanvas component`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Timeline.tsx ~1400 ‚Üí ~800 —Å—Ç—Ä–æ–∫

---

### –ó–∞–¥–∞—á–∞ 2.4: –ò–∑–≤–ª–µ—á—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –≤ —Ö—É–∫–∏

#### –°–æ–∑–¥–∞—Ç—å useTimelineEvents —Ö—É–∫

`src/pages/timeline/hooks/useTimelineEvents.ts`:

```typescript
import { useState, useCallback } from 'react';
import type { NodeT, EdgeT } from '../types';
import { LINE_X_POSITION } from '../constants';

export function useTimelineEvents() {
  const [nodes, setNodes] = useState<NodeT[]>([]);
  const [selectedId, setSelectedId] = useState<string | null>(null);
  const [draggingNodeId, setDraggingNodeId] = useState<string | null>(null);

  const addNode = useCallback((node: Omit<NodeT, 'id'>) => {
    const newNode: NodeT = {
      ...node,
      id: crypto.randomUUID(),
    };
    setNodes((prev) => [...prev, newNode]);
    return newNode.id;
  }, []);

  const updateNode = useCallback((id: string, updates: Partial<NodeT>) => {
    setNodes((prev) => prev.map((n) => (n.id === id ? { ...n, ...updates } : n)));
  }, []);

  const deleteNode = useCallback((id: string) => {
    setNodes((prev) => prev.filter((n) => n.id !== id));
    setSelectedId(null);
  }, []);

  return {
    nodes,
    setNodes,
    selectedId,
    setSelectedId,
    draggingNodeId,
    setDraggingNodeId,
    addNode,
    updateNode,
    deleteNode,
  };
}
```

**–ö–æ–º–º–∏—Ç:** `refactor(timeline): extract useTimelineEvents hook`

#### –°–æ–∑–¥–∞—Ç—å useTimelineBranches —Ö—É–∫

`src/pages/timeline/hooks/useTimelineBranches.ts`:

```typescript
import { useState, useCallback } from 'react';
import type { EdgeT } from '../types';

export function useTimelineBranches() {
  const [edges, setEdges] = useState<EdgeT[]>([]);
  const [selectedBranchX, setSelectedBranchX] = useState<number | null>(null);

  const addEdge = useCallback((edge: Omit<EdgeT, 'id'>) => {
    const newEdge: EdgeT = {
      ...edge,
      id: crypto.randomUUID(),
    };
    setEdges((prev) => [...prev, newEdge]);
    return newEdge.id;
  }, []);

  const updateEdge = useCallback((id: string, updates: Partial<EdgeT>) => {
    setEdges((prev) => prev.map((e) => (e.id === id ? { ...e, ...updates } : e)));
  }, []);

  const deleteEdge = useCallback((id: string) => {
    setEdges((prev) => prev.filter((e) => e.id !== id));
  }, []);

  return {
    edges,
    setEdges,
    selectedBranchX,
    setSelectedBranchX,
    addEdge,
    updateEdge,
    deleteEdge,
  };
}
```

**–ö–æ–º–º–∏—Ç:** `refactor(timeline): extract useTimelineBranches hook`

#### –°–æ–∑–¥–∞—Ç—å useTimelineTransform —Ö—É–∫

`src/pages/timeline/hooks/useTimelineTransform.ts`:

```typescript
import { useState, useCallback } from 'react';
import type { Transform } from '../types';
import { MIN_SCALE, MAX_SCALE, LINE_X_POSITION } from '../constants';
import { clamp } from '../utils';

export function useTimelineTransform(initialTransform: Transform = { x: 50, y: 100, k: 1 }) {
  const [transform, setTransform] = useState<Transform>(initialTransform);
  const [isPanning, setIsPanning] = useState(false);
  const [lastPointer, setLastPointer] = useState<{ x: number; y: number } | null>(null);

  const handleWheel = useCallback((e: React.WheelEvent) => {
    e.preventDefault();
    const scaleBy = 1 + -e.deltaY * 0.001;
    const newK = clamp(transform.k * scaleBy, MIN_SCALE, MAX_SCALE);

    const centerY = window.innerHeight / 2;
    const lineScreenX = transform.x + LINE_X_POSITION * transform.k;

    setTransform({
      k: newK,
      x: lineScreenX - LINE_X_POSITION * newK,
      y: transform.y + (centerY - transform.y) * (1 - newK / transform.k),
    });
  }, [transform]);

  const startPanning = useCallback((x: number, y: number) => {
    setIsPanning(true);
    setLastPointer({ x, y });
  }, []);

  const updatePanning = useCallback((x: number, y: number) => {
    if (isPanning && lastPointer) {
      const dx = x - lastPointer.x;
      const dy = y - lastPointer.y;
      setTransform((t) => ({ ...t, x: t.x + dx, y: t.y + dy }));
      setLastPointer({ x, y });
    }
  }, [isPanning, lastPointer]);

  const stopPanning = useCallback(() => {
    setIsPanning(false);
    setLastPointer(null);
  }, []);

  return {
    transform,
    setTransform,
    isPanning,
    handleWheel,
    startPanning,
    updatePanning,
    stopPanning,
  };
}
```

**–ö–æ–º–º–∏—Ç:** `refactor(timeline): extract useTimelineTransform hook`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Timeline.tsx ~800 ‚Üí ~400 —Å—Ç—Ä–æ–∫

---

## Phase 3: –ì–ª—É–±–æ–∫–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ (1-2 –Ω–µ–¥–µ–ª–∏)

### –ó–∞–¥–∞—á–∞ 3.1: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å BulkEventCreator (263‚Üí180 —Å—Ç—Ä–æ–∫)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–º–µ—à–∏–≤–∞–µ—Ç UI –∏ –ª–æ–≥–∏–∫—É –ø–∞—Ä—Å–∏–Ω–≥–∞

**–†–µ—à–µ–Ω–∏–µ:** –ò–∑–≤–ª–µ—á—å –ª–æ–≥–∏–∫—É –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤ —É—Ç–∏–ª–∏—Ç—É

`src/pages/timeline/utils/parseBulkEvents.ts`:

```typescript
import type { NodeT, EdgeT } from '../types';
import { parseAge } from './index';

export interface BulkEventInput {
  age: number;
  label: string;
}

export function parseBulkEventsText(text: string): BulkEventInput[] {
  const lines = text.trim().split('\n').filter(line => line.trim());
  const events: BulkEventInput[] = [];

  for (const line of lines) {
    const match = line.match(/^(\d+(?:[.,]\d+)?)\s*[,;:]\s*(.+)$/);
    if (match) {
      const age = parseAge(match[1]);
      const label = match[2].trim();
      if (label) {
        events.push({ age, label });
      }
    }
  }

  return events;
}

export function validateBulkEvents(
  events: BulkEventInput[],
  ageMax: number,
  selectedEdge?: EdgeT | null
): { valid: boolean; errors: string[] } {
  const errors: string[] = [];

  for (const event of events) {
    if (event.age < 0 || event.age > ageMax) {
      errors.push(`–í–æ–∑—Ä–∞—Å—Ç ${event.age} –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã 0-${ageMax}`);
    }

    if (selectedEdge) {
      if (event.age < selectedEdge.startAge || event.age > selectedEdge.endAge) {
        errors.push(
          `–í–æ–∑—Ä–∞—Å—Ç ${event.age} –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –¥–∏–∞–ø–∞–∑–æ–Ω –≤–µ—Ç–∫–∏ (${selectedEdge.startAge}-${selectedEdge.endAge})`
        );
      }
    }
  }

  return {
    valid: errors.length === 0,
    errors,
  };
}
```

–û–±–Ω–æ–≤–∏—Ç—å BulkEventCreator –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É—Ç–∏–ª–∏—Ç.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** BulkEventCreator 263 ‚Üí ~180 —Å—Ç—Ä–æ–∫
**–ö–æ–º–º–∏—Ç:** `refactor(timeline): extract bulk events parsing logic`

---

### –ó–∞–¥–∞—á–∞ 3.2: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å SaveEventAsNoteButton (243‚Üí150 —Å—Ç—Ä–æ–∫)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –º–Ω–æ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:** –ò–∑–≤–ª–µ—á—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —É—Ç–∏–ª–∏—Ç—É

`src/pages/timeline/utils/formatEventAsNote.ts`:

```typescript
import type { Sphere } from '../types';
import { ageToRange } from './ageToRange';
import { AGE_RANGE_LABELS } from '../../../types/notes';
import { SPHERE_META } from '../constants';

export interface EventData {
  age: number;
  title: string;
  notes: string;
  sphere?: Sphere;
}

export function formatEventAsNote(event: EventData): {
  title: string;
  content: string;
  ageRange: string;
} {
  const ageRange = ageToRange(event.age);
  const ageRangeLabel = AGE_RANGE_LABELS[ageRange];
  const sphereLabel = event.sphere ? SPHERE_META[event.sphere].label : '–ù–µ —É–∫–∞–∑–∞–Ω–æ';

  const content = `**–í–æ–∑—Ä–∞—Å—Ç:** ${event.age} –ª–µ—Ç
**–ü–µ—Ä–∏–æ–¥:** ${ageRangeLabel}
**–°—Ñ–µ—Ä–∞ –∂–∏–∑–Ω–∏:** ${sphereLabel}

${event.notes ? `**–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏:**\n${event.notes}` : ''}`.trim();

  return {
    title: event.title,
    content,
    ageRange,
  };
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** SaveEventAsNoteButton 243 ‚Üí ~150 —Å—Ç—Ä–æ–∫
**–ö–æ–º–º–∏—Ç:** `refactor(timeline): extract event formatting logic`

---

### –ó–∞–¥–∞—á–∞ 3.3: –î–æ–±–∞–≤–∏—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è —É—Ç–∏–ª–∏—Ç

#### –¢–µ—Å—Ç—ã –¥–ª—è parseBulkEvents

`src/pages/timeline/utils/__tests__/parseBulkEvents.test.ts`:

```typescript
import { parseBulkEventsText, validateBulkEvents } from '../parseBulkEvents';

describe('parseBulkEventsText', () => {
  it('should parse valid events', () => {
    const text = `
      18, –ü–æ—Å—Ç—É–ø–∏–ª –≤ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç
      22, –ü–µ—Ä–≤–∞—è —Ä–∞–±–æ—Ç–∞
      25,5, –ü–æ–≤—ã—à–µ–Ω–∏–µ
    `;
    const events = parseBulkEventsText(text);

    expect(events).toHaveLength(3);
    expect(events[0]).toEqual({ age: 18, label: '–ü–æ—Å—Ç—É–ø–∏–ª –≤ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç' });
    expect(events[1]).toEqual({ age: 22, label: '–ü–µ—Ä–≤–∞—è —Ä–∞–±–æ—Ç–∞' });
    expect(events[2]).toEqual({ age: 25.5, label: '–ü–æ–≤—ã—à–µ–Ω–∏–µ' });
  });

  it('should handle different separators', () => {
    const text = '18: Event 1\n22; Event 2\n25, Event 3';
    const events = parseBulkEventsText(text);
    expect(events).toHaveLength(3);
  });

  it('should ignore invalid lines', () => {
    const text = `
      18, Valid event
      Invalid line without comma
      Not a number, Event
    `;
    const events = parseBulkEventsText(text);
    expect(events).toHaveLength(1);
  });
});

describe('validateBulkEvents', () => {
  it('should validate age range', () => {
    const events = [
      { age: 18, label: 'Event 1' },
      { age: 150, label: 'Event 2' }, // Invalid
    ];

    const result = validateBulkEvents(events, 100);
    expect(result.valid).toBe(false);
    expect(result.errors).toHaveLength(1);
  });

  it('should validate branch age range', () => {
    const events = [{ age: 25, label: 'Event' }];
    const selectedEdge = {
      id: '1',
      x: 2100,
      startAge: 18,
      endAge: 22,
      color: '#000',
      nodeId: 'node1',
    };

    const result = validateBulkEvents(events, 100, selectedEdge);
    expect(result.valid).toBe(false);
  });
});
```

**–ö–æ–º–º–∏—Ç:** `test(timeline): add tests for parseBulkEvents`

#### –¢–µ—Å—Ç—ã –¥–ª—è formatEventAsNote

`src/pages/timeline/utils/__tests__/formatEventAsNote.test.ts`:

```typescript
import { formatEventAsNote } from '../formatEventAsNote';

describe('formatEventAsNote', () => {
  it('should format event with all fields', () => {
    const event = {
      age: 18,
      title: '–ü–æ—Å—Ç—É–ø–∏–ª –≤ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç',
      notes: '–ú–ì–£, —Ñ–∞–∫—É–ª—å—Ç–µ—Ç –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏',
      sphere: 'education' as const,
    };

    const result = formatEventAsNote(event);

    expect(result.title).toBe('–ü–æ—Å—Ç—É–ø–∏–ª –≤ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç');
    expect(result.content).toContain('18 –ª–µ—Ç');
    expect(result.content).toContain('–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ');
    expect(result.content).toContain('–ú–ì–£, —Ñ–∞–∫—É–ª—å—Ç–µ—Ç –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏');
    expect(result.ageRange).toBe('adolescence');
  });

  it('should handle event without notes', () => {
    const event = {
      age: 25,
      title: '–°–æ–±—ã—Ç–∏–µ',
      notes: '',
    };

    const result = formatEventAsNote(event);
    expect(result.content).not.toContain('–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏:');
  });
});
```

**–ö–æ–º–º–∏—Ç:** `test(timeline): add tests for formatEventAsNote`

#### –¢–µ—Å—Ç—ã –¥–ª—è ageToRange

`src/pages/timeline/utils/__tests__/ageToRange.test.ts`:

```typescript
import { ageToRange } from '../ageToRange';

describe('ageToRange', () => {
  it('should return correct range for infancy', () => {
    expect(ageToRange(0)).toBe('infancy');
    expect(ageToRange(1)).toBe('infancy');
    expect(ageToRange(2)).toBe('infancy');
  });

  it('should return correct range for preschool', () => {
    expect(ageToRange(3)).toBe('preschool');
    expect(ageToRange(6)).toBe('preschool');
  });

  it('should handle boundary cases (prefer older period)', () => {
    expect(ageToRange(7)).toBe('primary-school'); // –ì—Ä–∞–Ω–∏—Ü–∞ 7 –ª–µ—Ç
    expect(ageToRange(10)).toBe('middle-school'); // –ì—Ä–∞–Ω–∏—Ü–∞ 10 –ª–µ—Ç
  });

  it('should handle very old ages', () => {
    expect(ageToRange(80)).toBe('late-adulthood');
    expect(ageToRange(100)).toBe('late-adulthood');
  });
});
```

**–ö–æ–º–º–∏—Ç:** `test(timeline): add tests for ageToRange`

---

### –ó–∞–¥–∞—á–∞ 3.4: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –¥–æ—Ä–æ–≥–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

–í TimelineCanvas –¥–æ–±–∞–≤–∏—Ç—å –º–µ–º–æ–∏–∑–∞—Ü–∏—é:

```typescript
import { useMemo } from 'react';

export function TimelineCanvas(props: TimelineCanvasProps) {
  // –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ —Ä–∞–¥–∏—É—Å–∞
  const adaptiveRadius = useMemo(
    () => clamp(BASE_NODE_RADIUS / props.transform.k, MIN_NODE_RADIUS, MAX_NODE_RADIUS),
    [props.transform.k]
  );

  // –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
  const visibleNodes = useMemo(
    () => props.nodes.filter(node =>
      typeof node.age === 'number' && !isNaN(node.age)
    ),
    [props.nodes]
  );

  // –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤–µ—Ç–æ–∫
  const visibleEdges = useMemo(
    () => props.edges.filter(edge =>
      typeof edge.x === 'number' &&
      typeof edge.startAge === 'number' &&
      typeof edge.endAge === 'number' &&
      !isNaN(edge.x) &&
      !isNaN(edge.startAge) &&
      !isNaN(edge.endAge)
    ),
    [props.edges]
  );

  // ...
}
```

**–ö–æ–º–º–∏—Ç:** `perf(timeline): add memoization for expensive calculations`

---

### –ó–∞–¥–∞—á–∞ 3.5: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

–û–±–Ω–æ–≤–∏—Ç—å TimelineGuide.md —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ:

```markdown
## –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (–ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞)

### –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- **Timeline.tsx** (~400 —Å—Ç—Ä–æ–∫) - –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É –¥–æ—á–µ—Ä–Ω–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### –ü–∞–Ω–µ–ª–∏
- **TimelineLeftPanel.tsx** (~200 —Å—Ç—Ä–æ–∫) - –ª–µ–≤–∞—è –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **TimelineRightPanel.tsx** (~150 —Å—Ç—Ä–æ–∫) - –ø—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å —Å —Ñ–æ—Ä–º–∞–º–∏

### Canvas
- **TimelineCanvas.tsx** (~400 —Å—Ç—Ä–æ–∫) - SVG-—Ö–æ–ª—Å—Ç —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π

### –§–æ—Ä–º—ã
- **TimelineEventForm.tsx** (~150 —Å—Ç—Ä–æ–∫) - —Ñ–æ—Ä–º–∞ —Å–æ–±—ã—Ç–∏—è
- **TimelineBirthForm.tsx** (~80 —Å—Ç—Ä–æ–∫) - —Ñ–æ—Ä–º–∞ –ø—Ä–æ—Ñ–∏–ª—è —Ä–æ–∂–¥–µ–Ω–∏—è
- **TimelineBranchEditor.tsx** (~70 —Å—Ç—Ä–æ–∫) - —Ä–µ–¥–∞–∫—Ç–æ—Ä –≤–µ—Ç–æ–∫

### –•—É–∫–∏
- **useTimelineEvents.ts** (~80 —Å—Ç—Ä–æ–∫) - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è–º–∏
- **useTimelineBranches.ts** (~60 —Å—Ç—Ä–æ–∫) - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ç–∫–∞–º–∏
- **useTimelineTransform.ts** (~100 —Å—Ç—Ä–æ–∫) - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–µ–π —Ö–æ–ª—Å—Ç–∞
- **useTimelineHistory.ts** (~93 —Å—Ç—Ä–æ–∫–∏) - undo/redo

### –£—Ç–∏–ª–∏—Ç—ã
- **parseBulkEvents.ts** (~80 —Å—Ç—Ä–æ–∫) - –ø–∞—Ä—Å–∏–Ω–≥ –º–∞—Å—Å–æ–≤–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
- **formatEventAsNote.ts** (~50 —Å—Ç—Ä–æ–∫) - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –∫–∞–∫ –∑–∞–º–µ—Ç–∫–∏
- **exportJSON.ts** (~30 —Å—Ç—Ä–æ–∫) - —ç–∫—Å–ø–æ—Ä—Ç –≤ JSON
- **exportPNG.ts** (~280 —Å—Ç—Ä–æ–∫) - —ç–∫—Å–ø–æ—Ä—Ç –≤ PNG
- **exportPDF.ts** (~320 —Å—Ç—Ä–æ–∫) - —ç–∫—Å–ø–æ—Ä—Ç –≤ PDF
```

**–ö–æ–º–º–∏—Ç:** `docs(timeline): update guide with new structure`

---

## –ß–µ–∫–ª–∏—Å—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–º–∏—Ç–∞

- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ (`npm run dev`)
- [ ] TypeScript –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ (`npm run build`)
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Phase 1)

**–≠–∫—Å–ø–æ—Ä—Ç:**
- [ ] JSON —ç–∫—Å–ø–æ—Ä—Ç —Å–æ–∑–¥–∞—ë—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–∞–π–ª
- [ ] PNG —ç–∫—Å–ø–æ—Ä—Ç —Å–æ–∑–¥–∞—ë—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- [ ] PDF —ç–∫—Å–ø–æ—Ä—Ç —Å–æ–∑–¥–∞—ë—Ç PDF-–¥–æ–∫—É–º–µ–Ω—Ç
- [ ] –í—Å–µ —Ñ–æ—Ä–º–∞—Ç—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Phase 2)

**–õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å:**
- [ ] –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç –ª–∏–Ω–∏—é –∂–∏–∑–Ω–∏
- [ ] –ü–æ–ª–∑—É–Ω–æ–∫ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç –≤—å—é–ø–æ—Ä—Ç
- [ ] –ü–æ–ª–∑—É–Ω–æ–∫ –º–∞—Å—à—Ç–∞–±–∞ –∏–∑–º–µ–Ω—è–µ—Ç zoom
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–±—ã—Ç–∏–π –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –ö–Ω–æ–ø–∫–∞ "–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë" —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å:**
- [ ] –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ–Ω—è–µ—Ç —Ü–≤–µ—Ç
- [ ] –°–µ–ª–µ–∫—Ç–æ—Ä –ø–µ—Ä–∏–æ–¥–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –§–æ—Ä–º—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**Canvas:**
- [ ] –°–æ–±—ã—Ç–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ —Ö–æ–ª—Å—Ç–µ
- [ ] –í–µ—Ç–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–ª–µ—Å–æ–º –º—ã—à–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ —Ö–æ–ª—Å—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç

**–§–æ—Ä–º—ã:**
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è
- [ ] –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç

### –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Phase 3)

**–í—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–π –ª–∏–Ω–∏–∏
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –Ω–∞ –≤–µ—Ç–∫–µ
- [ ] –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –≤–ª–µ–≤–æ/–≤–ø—Ä–∞–≤–æ
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –≤–µ—Ç–∫–∏ –æ—Ç —Å–æ–±—ã—Ç–∏—è
- [ ] –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –≤–µ—Ç–∫–∏
- [ ] –£–¥–∞–ª–µ–Ω–∏–µ –≤–µ—Ç–∫–∏ (—Å–æ–±—ã—Ç–∏—è –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é –ª–∏–Ω–∏—é)
- [ ] –ú–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –∫–∞–∫ –∑–∞–º–µ—Ç–∫–∏
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–º–µ—Ç–∫–∏ –∫–∞–∫ —Å–æ–±—ã—Ç–∏—è
- [ ] –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è —Ä–æ–∂–¥–µ–Ω–∏—è
- [ ] –í—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–≤–∏—Ç–∏—è
- [ ] –ö–ª–∏–∫ –ø–æ –≥—Ä–∞–Ω–∏—Ü–µ –ø–µ—Ä–∏–æ–¥–æ–≤
- [ ] Undo/Redo –æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ (Cmd+Z, Cmd+Shift+Z, Delete, Escape)

**–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:**
- [ ] –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Firestore —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
- [ ] –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è
- [ ] –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Å—Ç–∞—Ç—É—Å

**Edge cases:**
- [ ] –ü—É—Å—Ç–æ–π —Ç–∞–π–º–ª–∞–π–Ω –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –¢–∞–π–º–ª–∞–π–Ω —Å 1000+ —Å–æ–±—ã—Ç–∏—è–º–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –ª–∞–≥–æ–≤
- [ ] –°–æ–±—ã—Ç–∏—è —Å –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –Ω–µ –ª–æ–º–∞—é—Ç UI
- [ ] –í–µ—Ç–∫–∏ —Å –ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏–º–∏—Å—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- [ ] –í–æ–∑—Ä–∞—Å—Ç > 100 –ª–µ—Ç –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π

---

## –ü—Ä–æ—Ü–µ–¥—É—Ä—ã –æ—Ç–∫–∞—Ç–∞

### –û—Ç–∫–∞—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∫–æ–º–º–∏—Ç–∞

```bash
# –û—Ç–∫–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–º–º–∏—Ç–∞ (—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è)
git reset --soft HEAD~1

# –û—Ç–∫–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–º–º–∏—Ç–∞ (—É–¥–∞–ª–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è)
git reset --hard HEAD~1

# –û—Ç–∫–∞—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–æ–º–º–∏—Ç–∞
git revert <commit-hash>
```

### –û—Ç–∫–∞—Ç –∫ –Ω–∞—á–∞–ª—É —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

```bash
# –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ç–µ–≥—É timeline-refactor-start
git checkout timeline-refactor-start

# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ç–∫—É –æ—Ç —ç—Ç–æ–π —Ç–æ—á–∫–∏
git checkout -b refactor/timeline-v2
```

### –û—Ç–∫–∞—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

```bash
# –í–µ—Ä–Ω—É—Ç—å —Ñ–∞–π–ª –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é –∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–æ–º–º–∏—Ç–∞
git checkout <commit-hash> -- path/to/file.tsx
```

---

## –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–æ–¥–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ | –ü–æ—Å–ª–µ Phase 1 | –ü–æ—Å–ª–µ Phase 2 | –ü–æ—Å–ª–µ Phase 3 | –¶–µ–ª—å |
|---------|----------------|---------------|---------------|---------------|------|
| **–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫** | 4589 | 4500 | 3800 | 3200 | 3000-3500 |
| **Timeline.tsx** | 2109 | 2109 | 800 | 400 | <500 |
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤** | 6 | 6 | 12 | 12 | 10-15 |
| **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞** | 2109 | 2109 | 800 | 400 | <500 |
| **–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏** | 0% | 5% | 10% | 30% | >25% |

### –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –¶–µ–ª—å |
|---------|-----|-------|------|
| **–í—Ä–µ–º—è —Ä–µ–Ω–¥–µ—Ä–∞ (1000 —Å–æ–±—ã—Ç–∏–π)** | ? | ? | <100ms |
| **–†–∞–∑–º–µ—Ä –±–∞–Ω–¥–ª–∞ Timeline** | ? | ? | -15% |
| **Time to Interactive** | ? | ? | <3s |

### –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –¶–µ–ª—å |
|---------|-----|-------|------|
| **–ö–æ–≥–Ω–∏—Ç–∏–≤–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å Timeline.tsx** | –í—ã—Å–æ–∫–∞—è | –°—Ä–µ–¥–Ω—è—è | –ù–∏–∑–∫–∞—è |
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—Å–æ–≤ –≤ Timeline** | 0 (–≤—Å–µ –≤–Ω—É—Ç—Ä–∏) | 30+ | <15 |
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ useState –≤ Timeline** | 34 | 10 | <15 |

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠—Ç–æ—Ç –ø–ª–∞–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ—à–∞–≥–æ–≤—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã —Ç–∞–π–º–ª–∞–π–Ω–∞ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞:

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –∫–∞–∂–¥—ã–π —à–∞–≥ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è, –µ—Å—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –æ—Ç–∫–∞—Ç–∞
2. **–ò–∑–º–µ—Ä–∏–º–æ—Å—Ç—å**: —á—ë—Ç–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞
3. **–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ—Å—Ç—å**: —Ç—Ä–∏ —Ñ–∞–∑—ã —Å –Ω–∞—Ä–∞—Å—Ç–∞—é—â–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é
4. **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å**: –∏—Ç–æ–≥–æ–≤—ã–π –∫–æ–¥ –ª–µ–≥—á–µ —á–∏—Ç–∞—Ç—å –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:
- Timeline.tsx —Å–æ–∫—Ä–∞—Ç–∏—Ç—Å—è —Å 2109 –¥–æ ~400 —Å—Ç—Ä–æ–∫ (—Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –Ω–∞ 81%)
- –ü–æ—è–≤–∏—Ç—Å—è 12 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤–º–µ—Å—Ç–æ –º–æ–Ω–æ–ª–∏—Ç–∞
- –ö–æ–¥ –±—É–¥–µ—Ç –ø–æ–∫—Ä—ã—Ç —Ç–µ—Å—Ç–∞–º–∏ –Ω–∞ >25%
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å—Ç–∞–Ω–µ—Ç –±–æ–ª–µ–µ –º–æ–¥—É–ª—å–Ω–æ–π –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ–π

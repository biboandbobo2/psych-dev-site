# Краткий гайд по архитектурным принципам

Ссвяжитесь с `docs/ARCHITECTURE_GUIDELINES.md` для подробностей, а здесь — то, что важно помнить перед любой задачей или рефакторингом.

## Основные принципы
1. **SRP и композиция:** каждый компонент или хук отвечает за одну концепцию. Если появляется много `useState`, рассматривайте деление на подкомпоненты или кастомные хуки.
2. **DRY + переиспользуемые хуки:** дублирование логики (например в `Notes`/`Timeline`) стоит вынести в хуки (`useNotes`, `useTimeline`, `useContentEditor`).
3. **Feature-based структура:** добавляйте файлы рядом с функцией (например, `src/pages/notes/components`, `src/pages/admin/topics`).
4. **Управление состоянием:** минимизируйте глобальные контексты, используйте локальные хранилища (например, `useTimeline`) и утилиты (`notesExport.ts`).
5. **Тестируемость:** пишите тесты для критичных потоков (см. `docs/CORE_REFACTORING_PLAN.md` и `docs/TESTS_SYSTEM_GUIDE.md`).

## Практические пункты перед задачей
- Проверьте, нет ли похожей логики в `src/hooks` или `src/utils`. Возможно, достаточно расширить существующий хук.
- Оцените размер файла: если он превышает 250–300 строк (за исключением canvas/высокоинтерактивных файлов), подумайте о разбиении.
- Убедитесь, что добавляемые стили используют существующие палитры/стили (см. `theme.ts`, `color.ts`).
- Перед коммитом прогоните `npm run test` (или минимальные `vitest`), а для UI — `npm run build` и ручной smoke, если влияет на ключевые flows.

## Чеклист для рефакторинга
- [ ] Отделил логику в хук/утилиту, если компонент растёт. (`Notes`, `NoteModal`, `SaveNoteAsEventButton` — примеры).
- [ ] Обновил документацию (особенно `docs/CORE_REFACTORING_PLAN.md` или `docs/TIMELINE_REFACTORING_PLAN.md`) если затронул архитектурные компоненты.
- [ ] Добавил/обновил тесты для критичного поведения (`SaveNoteAsEventButton`, `useTimeline`).
- [ ] Указал manual smoke/QA в `docs/REFRACTORING_ARCHIVE.md` или `docs/PLANS_OVERVIEW.md`.

Ссылки: см. `docs/ARCHITECTURE_GUIDELINES.md` для примеров и шаблонов кода и `docs/PLANS_OVERVIEW.md` для текущих статусов.
